{% extends 'base.html.twig' %}

{% block title %} | Accueil{% endblock %}

{% block body %}
    <div class="w3-row-padding w3-light-grey w3-padding-64 w3-container">

                <div class="form_plus_card w3-row">
                    <form class="w3-container home_form w3-col" method="post" action="{{ path('home') }}">
                        <h2 class="titre_form_accueil">Filtrer les sorties</h2>

                        <label for="campus_list" class="campus_lbl">Campus</label>
                        <select class="w3-select campus_list" id="campus_list">
                            {% for campus in campusList %}
                                <option value="{{ campus.id }}">{{ campus.name }}</option>
                            {% endfor %}
                        </select>


                        <label for="search_input" class="search_lbl">Le nom de la sortie contient :</label>
                        <input type="text" class="search_input w3-input" id="search_input" name="search_input">

                        <label for="date_debut" class="date_debut_lbl">Entre</label>
                        <input type="date" class="date_debut w3-input" id="date_debut" name="date_debut">

                        <label for="date_fin" class="date_fin_lbl">et</label>
                        <input type="date" class="date_fin w3-input" id="date_fin" name="date_fin">
                        <br>

                        <div class="checkbx">

                            <div>
                                <input type="checkbox" class="user_organisateur w3-check" id="user_organisateur" name="user_organisateur">
                                <label for="user_organisateur" class="user_organisateur_lbl">Sorties dont je suis l'organisateur/trice</label>
                            </div>

                            <div>
                                <input type="checkbox" class="user_inscrits w3-check" id="user_inscrits" name="user_inscrits">
                                <label for="user_inscrits" class="user_inscrits_lbl">Sorties auxquelles je suis inscrit/e</label>
                            </div>

                            <div>
                                <input type="checkbox" class="user_non_inscrits w3-check" id="user_non_inscrits" name="user_non_inscrits">
                                <label for="user_non_inscrits" class="user_non_inscrits_lbl">Sorties auxquelles je ne suis pas inscrit/e</label>
                            </div>

                            <div>
                                <input type="checkbox" class="sorties_passees w3-check" id="sorties_passees" name="sorties_passees">
                                <label for="sorties_passees" class="sorties_passees_lbl">Sorties passées</label>
                            </div>
                        </div>
                        <button class="w3-btn w3-round" type="submit" style="background: #f44336; margin: 10px;">Valider</button>
                    </form>

                    <div class="w3-card aside w3-col w3-center w3-right">
                        <p class="dateJour">Date du jour : {{ "now"|date('d/m/Y') }}</p>
                        <p class="userName">Participant : {{ app.user.firstName }}</p>
                    </div>
                </div>
                <div class="tableau_list_event">
                    <table class="w3-table w3-striped w3-border w3-centered">
                        <tr>
                            <th>Nom de la sortie</th>
                            <th>Date de la sortie</th>
                            <th>Clôture</th>
                            <th>inscrits/places</th>
                            <th>Etat</th>
                            <th>Inscrit</th>
                            <th>Organisateur</th>
                            <th>Actions</th>
                        </tr>
                        {% for event in eventList %}
                        <tr>
                            <td>{{ event.name }}</td>
                            <td>{{ event.startDateTime ? event.startDateTime|date('d-m-Y H:i:s') : '' }}</td>
                            <td>{{ event.registrationLimitDate ? event.registrationLimitDate|date('d-m-Y H:i:s') : '' }}</td>
                            <td>{{ event.registrations|length }}/{{ event.registrationMaxNb }}</td>
                            <td>{{ event.state.label }}</td>

                            <td>
                            {% for registration in registrationList %}
                                     {{ (registration.participant.id == app.user.id and registration.event.id == event.id)? 'X' :'' }}
                            {% endfor %}
                            </td>
                            <td>{{ event.owner.firstName }}</td>
                            <td>
                                {% if event.registrations.count < event.registrationMaxNb and date(event.registrationLimitDate) > date() and event.state.label == 'ouverte' %}
                                 <a href="{{ url('event_detail', {'id': event.id }) }}">{{ "S'inscrire" }}</a>
                                {% endif %}
                                <a href="{{ url('event_detail', {'id': event.id}) }}">Afficher</a>
                                <a href="{{ url('event_edit', {'id': event.id}) }}">Modifier</a>
                            </td>

                        </tr>
                        {% endfor %}

                    </table>
                    <br>

              </div>

                    <a href="{{ url('event_add')}}" class="w3-btn w3-red w3-round">Créer une sortie</a>
                </div>


{#        {% for event in eventListUserOwner %}#}
{#            <p>{{ event.name }}</p>#}
{#        {% endfor %}#}
    </div>


{% endblock %}